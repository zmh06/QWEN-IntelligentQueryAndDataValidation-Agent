# 项目文档

## 架构设计

本项目采用多代理（Multi-Agent）架构，主要包括以下核心组件：

1. **PlanAgent**：负责分析用户输入并决定使用哪个代理来处理请求。
2. **DataQueryAgent**：执行自然语言到SQL的转换，并返回格式化结果。
3. **RuleConfigAgent**：处理规则配置相关的请求。
4. **RuleExecutorAgent**：执行预定义的数据质量规则。
5. **ContextManager**：维护用户对话上下文，用于上下文感知的查询扩展。
6. **LLMClient**：封装大模型调用逻辑，支持生成SQL、自然语言和验证输出。
7. **Database**：提供数据库连接和查询功能。

## 技术栈

- **Python 3.x**：主要开发语言。
- **DashScope Qwen LLM**：作为底层大模型服务，用于生成SQL和自然语言。
- **YAML**：用于存储测试用例。
- **Logging**：统一的日志记录机制。
- **Requests**：用于与 DashScope API 进行通信。

## 数据流程

1. 用户输入 → 2. 上下文扩展 → 3. 意图识别 → 4. 代理选择 → 5. 执行处理 → 6. 输出格式化 → 7. 返回结果

## 使用说明

### 测试模式

- 程序启动时选择 `1` 可从 `test_cases.yaml` 加载预设测试用例。
- 测试结果会写入日志文件 `logs/test_execution.log` 并更新 YAML 文件中的 `actual_output` 和 `status` 字段。

### 交互模式

- 程序启动时选择 `2` 或直接回车进入交互式模式。
- 输入自然语言查询（如“数据库中有多少张表？”），系统将自动识别意图并返回结构化或自然语言结果。

## 贡献指南

欢迎贡献代码、改进提示词、优化测试逻辑等。请遵循以下原则：

1. Fork 本仓库并创建新分支。
2. 提交清晰的 commit message。
3. 遵循 PEP8 编码规范。
4. 提供必要的单元测试（如新增功能）。